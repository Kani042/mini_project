{% extends "base.html" %}

{% block title %}Orders - Royal Mart{% endblock %}

{% block content %}
  <!-- ensure shared stylesheet loaded -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/site.css') }}">

  <div class="container">
    <!-- header consistent with dashboard -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="mb-0">All Orders</h2>
      
    </div>

    {% if invoices %}
      <!-- match Dashboard style: same table classes and spacing -->
      <div class="table-responsive force-scroll">
        <table class="table table-striped table-sm">
          <thead>
            <tr>
              <th>Invoice #</th>
              <th>Customer</th>
              <th>Mobile</th>
              <th>Items</th>
              <th>Subtotal</th>
              <th>Tax</th>
              <th>Total</th>
              <th>Date</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            {% for invoice in invoices %}
              <tr>
                <td><strong>
                  {% if invoice.invoice_number %}
                    {{ invoice.invoice_number }}
                  {% else %}
                    INV-{{ "%06d"|format(invoice.id) }}
                  {% endif %}
                </strong></td>
                <td>{{ invoice.customer_name or "N/A" }}</td>
                <td>{{ invoice.mobile }}</td>
                <td>
                  <a href="{{ url_for('order_items', invoice_id=invoice.id) }}" class="badge bg-info text-decoration-none" title="View items for this invoice">View Items</a>
                </td>
                <td>${{ "%.2f"|format(invoice.subtotal) }}</td>
                <td>${{ "%.2f"|format(invoice.tax) }}</td>
                <td><strong>${{ "%.2f"|format(invoice.total) }}</strong></td>
                <td>
                  {% if invoice.created_at %}
                    {% if invoice.created_at is string %}
                      {{ invoice.created_at.split(' ')[0] }}
                    {% else %}
                      {{ invoice.created_at.strftime('%Y-%m-%d') }}
                    {% endif %}
                  {% else %}
                    N/A
                  {% endif %}
                </td>
                <td>
                  <a href="{{ url_for('invoice_view', invoice_id=invoice.id) }}" class="btn btn-sm btn-primary">View</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="alert alert-info">
        <h5>No Orders Yet</h5>
        <p>Start making sales! Go to <a href="/checkout">Checkout</a> to create an order.</p>
      </div>
    {% endif %}

    <style>
      .table-hover tbody tr:hover {
        background-color: #f5f5f5;
      }
    </style>
  </div>
{% endblock %}
