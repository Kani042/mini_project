{% extends "base.html" %}{% block content %}
<!-- added print/bill styles -->
<style>
  /* Bill (receipt) print layout */
  .bill {
    max-width: 78mm; /* typical 80mm receipt width minus margins */
    margin: 0 auto;
    font-family: "Helvetica Neue", Arial, sans-serif;
    color: #000;
    line-height: 1.15;
    font-size: 12px;
  }
  .bill h3, .bill h4 { margin: 4px 0; font-weight:700; }
  .bill .invoice-details, .bill .customer-details, .bill .totals { margin: 6px 0; }
  .bill table { width: 100%; border-collapse: collapse; font-size: 11px; }
  .bill table th, .bill table td { padding: 4px 2px; text-align: left; vertical-align: top; }
  .bill table thead th { font-weight:700; font-size:11px; }
  .bill .totals { text-align: right; font-weight:700; }
  .no-print { display: inline-block; } /* visible on screen */
  /* Print rules */
  @media print {
    /* page size for small receipt-like prints; some browsers may ignore exact width */
    @page { size: 80mm auto; margin: 5mm; }
    body * { visibility: hidden; }
    .bill, .bill * { visibility: visible; }
    .bill { position: absolute; left: 0; top: 0; width: 78mm; margin: 0; }
    /* hide any controls in print */
    .no-print { display: none !important; }
  }
  /* Small screen preview tweaks */
  @media screen {
    .bill { box-shadow: none; }
  }
</style>

<div class="bill">
  <div class="header-row" style="display:flex; justify-content:space-between; align-items:flex-start; gap:20px; margin-bottom:24px;">
    <div class="company-left" style="text-align:left; line-height:1.2;">
      <strong>A Square General Trading Pte Ltd</strong><br>
      997, Serangoon Road, #01-00A<br>
      Singapore - 328152
    </div>
    <div style="min-width:200px; text-align:right;">
      <!-- keep right-side content if needed -->
    </div>
  </div>

  <div class="d-flex justify-content-between">
    {% if invoice.id is defined %}
      <h3>Online Invoice INV-{{ "%06d"|format(invoice.id) }}</h3>
    {% else %}
      <h3>Invoice {{ invoice.invoice_number }}</h3>
    {% endif %}
    <img src="{{ url_for('static', filename='print.png') }}"
         alt="Print"
         title="Print / Save as PDF"
         style="cursor:pointer; width:28px; height:28px;"
         onclick="window.print()"
         class="no-print">
  </div>
  <div class="mb-3">
    <strong>Customer:</strong> {{ user.name or 'N/A' }}<br>
    <strong>Mobile:</strong> {{ user.mobile }}<br>
    <strong>Date:</strong> {{ invoice.created_at }}<br>
    <strong>Payment Mode:</strong> {{ invoice.payment_mode or invoice.payment or 'N/A' }}
  </div>
  <table class="table table-striped">
    <thead><tr><th>Item</th><th>Qty</th><th>Unit price</th><th>Line total</th></tr></thead>
    <tbody>
      {% for li in lines %}
      <tr>
        <td>{{ li.name }}</td>
        <td>{{ li.quantity }}</td>
        <td>${{ '%.2f'|format(li.unit_price) }}</td>
        <td>${{ '%.2f'|format(li.line_total) }}</td>
      </tr>
      {% endfor %}
    </tbody>
    <tfoot>
      <tr><th colspan="3" class="text-end">Subtotal</th><th>${{ '%.2f'|format(invoice.subtotal) }}</th></tr>
      <tr><th colspan="3" class="text-end">Tax</th><th>${{ '%.2f'|format(invoice.tax) }}</th></tr>
      <tr><th colspan="3" class="text-end">Total</th><th>${{ '%.2f'|format(invoice.total) }}</th></tr>
    </tfoot>
  </table>
</div>
{% endblock %}
